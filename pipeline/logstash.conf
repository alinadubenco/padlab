input {
    tcp {
        port => 19600
        codec => json_lines
    }
}

filter {
    grok {
        match => {
            "message" =>
            "^%{TIMESTAMP_ISO8601:timestamp}\s+%{LOGLEVEL:level}\s+%{NUMBER:pid}\s+---\s+\[\s*%{USERNAME:thread}\s*\]\s+%{JAVAFILE:class}\s*:\s*%{DATA:themessage}(?:\n+(?<stacktrace>(?:.|\r|\n)+))?$"
        }
    }
    date {
        match => ["timestamp", "yyyy-MM-dd HH:mm:ss.SSS"]
    }
    mutate {
        remove_field => ["@version"]
        add_field => {
            "appid" => "%{[path]}"
        }
        add_field => {
            "levell" => "level"
        }
        add_field => {
            "mensage" => "message"
        }
    }
}
output {
    elasticsearch {
        hosts => ["es01:9200"]
    }
    stdout {}
}
